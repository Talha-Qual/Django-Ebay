{% extends "auctions/layout.html" %}
{% load static %}
{% block main %}
<h2>Active Listings</h2>

<article>
    {% for listing in listings %}
    <section>
        <!-- Watchlist toggle stuff -->
        <div style = "float: right;">
          <form id = "watchlist-toggle" action = "{% url 'watchlist_toggle' listing.id %}" method = "POST">
            {% csrf_token %}
            {% if user.watchlist == True %}
            <input type = "image" src = "/media/images/bell_icon.png" style="max-height:50px;" id = "bell" >
            {% else %}
            <input type = "image" src = "/media/images/crossed_bell.png" style="max-height:50px;" id = "bell" >
            {% endif %}
          </form>
        </div>
        Title: {{listing.title}}
        <br>
        Description: {{listing.description}}
        <br>
        {% if listing.highestbid < listing.price %}
          Price: ${{listing.price}}
        {% else %}
          Price: ${{listing.highestbid}}
        {% endif %}
        <br>
        {% if listing.image %}
            <img src = "{{listing.image.url}}" alt = "there should be an image here" style = "max-height: 300px;">
            <br>
        {% endif %}

        {% for category in categories %}
        {% if listing.category == category.0 %}
          The category is: {{ category.1 }}
        {% endif %}
        {% endfor %}

        <br>
        <a href = "{% url 'view_listing' listing.id %}"><button>Check this out!</button></a>
    </section>

    {% endfor %}
  </article>
  
  <script src="{% static 'auctions/auctions.js' %}"></script>
{% endblock %}
